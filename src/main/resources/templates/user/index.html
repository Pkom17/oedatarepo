<!DOCTYPE HTML>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">

<head th:replace="fragments/header :: head">
</head>
<body class="sb-nav-fixed">
    <div class="d-flex" id="wrapper">
	    <div th:insert="fragments/side :: side"></div>
        <div id="page-content-wrapper">
            <div th:insert="fragments/header :: header"></div>
            <div class="container-fluid">
                <div class="card mb-4 mt-2">
                  <div class="card-header">
                    <i class="fas fa-table me-1"></i>
                    Liste des Utilisateurs
                    <a th:href="@{/user/new}" class="btn  btn-sm btn-primary float-end "> Ajouter un Utilisateur <i class="fas fa-plus me-1"></i> </a>
                  </div>
                  <div class="card-body">
                    <table class="table table-sm table-light table-striped table-bordered" id="tab_users">
                      <thead>
                        <th>N°</th>
                        <th>Email</th>
                        <th>Nom</th>
                        <th>Prénoms</th>
                        <th>Contact</th>
                        <th>Role</th>
                        <th>Date de dernière connexion</th>
                        <th>Editer</th>
                      </thead>
                      <tbody>
                        <tr th:each="item,idx : ${users}">
                          <td th:text="${idx.count}"></td>
                          <td th:text="${item.email}"></td>
                          <td th:text="${item.lastName}"></td>
                          <td th:text="${item.firstName}"></td>
                          <td th:text="${item.phoneContact}"></td>
                          <td th:text="${item.role}"></td>
                          <td th:text="${#dates.format(item.lastLogin, 'dd/MM/yyyy')}"></td>
                          <td>
                            <a th:href="@{'/user/details/'+${item?.id}}" class="btn  btn-sm btn-warning "> &nbsp; <i class="fas fa-user-edit"></i>&nbsp; </a>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
        </div>
    </div>
    <footer class="py-4 bg-light mt-auto" th:insert="fragments/footer :: footer"> </footer>
	<script th:src="@{/webjars/jquery/3.6.0/jquery.min.js}"></script>
	<script th:src="@{/webjars/bootstrap/5.1.3/js/bootstrap.min.js}"></script>
	<script th:src="@{/webjars/font-awesome/5.15.4/js/all.js}"></script>
  <script th:src="@{/DataTables/datatables.min.js}"></script>
  <script th:src="@{/js/scripts.js}"></script>
  <script type="text/javascript">
    $(document)
        .ready(
            function() {
              var table = $('#tab_users')
                  .DataTable(
                      {
                        dom : 'Bfrtip',
                        buttons : [ 'csv', 'excel',
                            'pdf' ],
                        language : {
                          url : "//cdn.datatables.net/plug-ins/1.11.5/i18n/fr-FR.json",
                        }
                      });
            });
  </script>
  
</body>
</html>
